---
calendar_date: 2023-06-22
catalog: true
categories:
- Windows
cover:
  image: /cover/cover26.jpeg
date: 2023-06-22 10:41:25
description: 使用Clash作为局域网中的代理服务器
lang: cn
mathjax: false
tags:
- Clash
- Proxy
thumbnail: /img/header_img/lml_bg26.jpg
title: Windows Clash局域网代理共享
toc: true
---

> 本文介绍基于 Windows Clash Desktop 的代理服务器设置，可以为局域网内的设备提供代理服务，该方案可以解决一定的科学上网需求，但是没办法覆盖所有的场景，例如 PS5 的 Netflix ，其不走代理服务器，因此无法通过该方案解决，（软路由可破）

本篇的设置内容主要会从两个方面出发：一个是服务器的开启和防火墙的设置、另一个是客户端如何设置使用对应的代理服务器。

## Clash开启代理服务器

Clash 作为局域网代理服务器开启的方式十分简单，主要是以下几步。

>开启局域网访问 -> 设置端口，查看 ip ->  防火墙允许通行

### 配置代理服务器

**开启局域网访问**： Allow LAN 打钩即可。
**端口**：设置好想要的 mixport 即可。

![image.png](https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230626091350.png)

**防火墙允许通行**： 防火墙-> 高级设置，找到 Clash 所有项，允许其在专用网络上通行。

![image.png](https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230626091506.png)
**查看 ip**：命令行输入 `ipconfig/ all` 里面的 WLAN 模块，可以找到自己的局域网 ip

![image.png](https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20230626091742.png)



### 一些坑 TroubleShoot

- 这一部分主要的问题在于，防火墙这一步很多地方都没有提到，这样会导致 Clash 被防火墙拦截，客户端就无法找到代理服务器，导致设置代理服务器后（比如 IOS），显示 WIFI 异常，无法访问网络的问题。
- 有一些相关的资料表示，如果连接失败，也有可能是 server 服务和 TAp 服务的原因，将两个服务卸载后在尝试即可。（这一部分我没有遇到）

## 客户端设置代理服务器

这里介绍一下 IOS 设置代理服务器的步骤，Ubuntu 等桌面系统（包含网络设置的）设置步骤都是差不多的，

### 实例：IOS

在 Wifi 链接的详细信息界面，选择配置代理服务器

![image.png](https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/mac/20230622110612.png)

进入设置页后，改为手动，输入我们设置好的代理服务器的 IP 和对应的端口即可。

![image.png](https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/mac/20230622110722.png)

设置完成后连接至该 WiFi 即可。